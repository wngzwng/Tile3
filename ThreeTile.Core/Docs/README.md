### Tile
> 三合游戏，存在卡槽

### 与麻将的二合的区别
1. Tile 可以存在悬空牌，即这张牌不是紧邻的上一层压住，而是上上层或者在之上的牌压住，影响：若是相邻层压与被压的关系用父子关系表示，则这个悬空牌会在这种关系中忽略掉了
2. 锁定关系：没有被压住，就是解锁的牌；左右不会锁定

#### 数据结构 与 常量
(x, y, z, w) 位置 + 花色，参考麻将的表示方式
考虑大麻将的处理
卡槽： 默认长度为7
配对数： 默认3 （3个一消除)
一个关卡平均麻将数： 200 ～ 300, 合法的数量是配对数的倍数

##### 出题
###### 正向出题
有一个关卡的空白模型，模拟用户操作进行染色，染色完成后，即完成一个关卡
> 优点： 直观，有解

#### 染色逻辑
1. 花色组的分配（即每个花色有几组），这个需要可以灵活控制
> 例子： 加入有228个麻将，三个一组，有 76 组，若每个花色两对，就有 38 种花色

选牌逻辑：
1. 选择一张牌，然后根据染色策略着色 ？ 根据染色策略，抽一张或者抽一组
2. 更新盘面，染色牌入槽
3. 卡槽更新

染色策略：不确定，有权重吗
对可染的颜色计算权重
权重来源：
1. 卡槽中牌的颜色和数量
2. 卡槽的可用空间
3. 可染颜色的数量分布情况

染色方案：
1. 3个
2. 2个1个
3. 1个2个

新的理解：
1. 花色组的字典 {color: 1, count: 6}
染色步骤：
1. 空模型选择空牌（数量收当前卡槽的数量的影响）
2. 卡槽牌 + 选择空牌 => 进行染色（可随机染色或者根据单曲的卡牌牌和卡槽可用空间选取权重)

##### 解题
Move 组
权重，选择
解锁牌，纯可见牌，卡槽牌，卡槽可用空间
> 纯可见牌收集: 遍历所有牌，找出至少有一个角没有被压的牌

选牌情况：
三个set：
卡槽set，解锁牌set，纯课件牌set
1. 可构成消除的情况：抽一组（多张牌）
    - 解锁牌，纯可见牌，卡槽牌，按照花色分类统计，只保留数量大于等于配对数的花色
    - 对于保留下来的花色，对于每一组花色的牌构成来源分类：
      - 可用来源：卡槽，解锁牌，纯可见牌
      - 每个可得到空间代价：
        - 卡槽为0，解锁牌为1，纯可见牌为解锁到该牌所需的牌在+1 （利用坐标投影可解决跨层问题）
      - 去除空间代价大于卡槽剩余空间的纯可见牌（不再计算，以及去除）
    计算代价后，再次根据配对数筛选
    根据当前卡槽剩余空间，可快速剪枝一部分空间代价不满足的花色组
    最后根据合法的组，计算权重
2. 不可构成消除的情况：抽一张
   - 权重来源：
     - 直接压的牌的数量
     - 展开牌是否构成消除
     - 暗牌部分

难度分：这个情况的价值
权重：难度分的调和平均
